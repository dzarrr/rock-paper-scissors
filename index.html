<!DOCTYPE html>
<html>
  <head>
    <title>Rock Paper Scissors!</title>
    <meta charset="UTF-8"/>
  </head>
  <body>
    <script>
      let possibleChoice = [
        'rock',
        'paper',
        'scissors'
      ]

      let score = {
        player: 0,
        computer: 0
      }

      function game(n = 5) {
        for (let i = 0; i < n; i ++) {
          let playerSelection = prompt('Rock, paper or scissors?');
          let computerSelection = possibleChoice[parseInt(Math.floor(Math.random() * possibleChoice.length))]
          if (validate(playerSelection)) {
            console.log(playRound(playerSelection, computerSelection));
          } else {
            alert('Invalid input, please choose between rock, paper, or scissors!');
          }
        }

        if (score.player > score.computer) {
          alert(`Congratulations! You win.\n Final score: player ${score.player}, computer ${score.computer}`);
        } else if (score.player < score.computer) {
          alert(`You lose.\n Final score: player ${score.player}, computer ${score.computer}`);
        } else {
          alert(`Draw\n Final score: player ${score.player}, computer ${score.computer}`);
        }
      }

      function updateScore(name){
        score[name] += 1;
      }

      function playRound(playerSelection, computerSelection) {
        if (playerSelection.toLowerCase() == computerSelection.toLowerCase()) {
          return `Draw, you both select ${playerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'rock') && (computerSelection.toLowerCase() == 'paper')) {
          updateScore('computer');
          return `You lose this round! ${computerSelection.toLowerCase()} beats ${playerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'rock') && (computerSelection.toLowerCase() == 'scissors')) {
          updateScore('player');
          return `You win this round! ${playerSelection.toLowerCase()} beats ${computerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'paper') && (computerSelection.toLowerCase() == 'scissors')) {
          updateScore('computer');
          return `You lose this round! ${computerSelection.toLowerCase()} beats ${playerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'paper') && (computerSelection.toLowerCase() == 'rock')) {
          updateScore('player');
          return `You win this round! ${playerSelection.toLowerCase()} beats ${computerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'scissors') && (computerSelection.toLowerCase() == 'rock')) {
          updateScore('computer');
          return `You lose this round! ${computerSelection.toLowerCase()} beats ${playerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'scissors') && (computerSelection.toLowerCase() == 'paper')) {
          updateScore('player');
          return `You win this round! ${playerSelection.toLowerCase()} beats ${computerSelection.toLowerCase()}`;
        }
      }

      function validate(playerSelection) {
        return possibleChoice.includes(playerSelection.toLowerCase());
      }

      game();
    </script>
  </body>
</html>